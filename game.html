<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Game Table</title>
	<style>
		input {
			width: 40px;
			text-align: center;
		}
	</style>
</head>
<body>
	<table border="1">
		<thead>
			<tr>
				<th>18-01-03</th>
				<th>Ashish</th>
				<th>Amod</th>
				<th>Rakesh</th>
				<th>Eric San</th>
				<td><button name="new-game" disabled>New Game</button></td>
			</tr>
		</thead>
		<tbody>
			<tr id="rowHands" class="current">
				<th>1</th>
				<td>
					<input type="number" name="ih" placeholder="IH" min="0" max="13" disabled value="0">
					<input type="number" name="fh" placeholder="FH" min="0" max="13" disabled value="1">
					<input type="number" name="score" disabled>
				</td>
				<td>
					<input type="number" name="ih" placeholder="IH" min="0" max="13" disabled value="3">
					<input type="number" name="fh" placeholder="FH" min="0" max="13" disabled value="2">
					<input type="number" name="score" disabled>
				</td>
				<td>
					<input type="number" name="ih" placeholder="IH" min="0" max="13" disabled value="4">
					<input type="number" name="fh" placeholder="FH" min="0" max="13" disabled value="1">
					<input type="number" name="score" disabled>
				</td>
				<td>
					<input type="number" name="ih" placeholder="IH" min="0" max="13" disabled value="2">
					<input type="number" name="fh" placeholder="FH" min="0" max="13" disabled value="3">
					<input type="number" name="score" disabled>
				</td>
				<td>
					<button disabled name="submit-ih">Submit IH</button>
					<button disabled name="submit-fh">Submit FH</button>
					<button disabled name="score">Score</button>
				</td>
			</tr>
		</tbody>
		<tfoot>
			<tr id="rowTotalScore">
				<th>Total</th>
				<th>-</th>
				<th>-</th>
				<th>-</th>
				<th>-</th>
				<th></th>
			</tr>
		</tfoot>
	</table>
	<script>
		let isInitialHandsSubmitted = false,
			isFinalHandsSubmitted = false,
			isScoreSubmitted = false,
			isInitialHandsFilled,
			isFinalHandsFilled,
			isScoreFilled,
			totalInitialHands,
			totalFinalHands;

		let submitNewGame = document.querySelector('button[name="new-game"]');
		let submitInitialHands = document.querySelector('.current button[name="submit-ih"]');
		let submitFinalHands = document.querySelector('button[name="submit-fh"]');
		let submitScore = document.querySelector('button[name="score"]');
		let inputInitialHands = document.querySelectorAll('.current input[name="ih"]');
		let inputFinalHands = document.querySelectorAll('input[name="fh"]');
		let inputScore = document.querySelectorAll('input[name="score"]');
		let rowTotalScore = document.querySelectorAll('#rowTotalScore th');
		let totalPlayers = 4;

		function resetSubmitInitialHands() {
			isInitialHandsSubmitted = false;
			isInitialHandsFilled = true;
			submitInitialHands.style.backgroundColor = '';
		}
		function calculateInitialHands() {
			totalInitialHands = 0;
			isInitialHandsSubmitted = false;
			isInitialHandsFilled = true;
			submitInitialHands.style.backgroundColor = 'grey';

			for(let i = 0; i < totalPlayers; i++) {
				if(inputInitialHands[i].value == "") {
					isInitialHandsFilled = false;
				}
				totalInitialHands += parseInt(inputInitialHands[i].value);
			}

			if(!isInitialHandsFilled) {
				submitInitialHands.style.backgroundColor = 'red';
				console.error("Don't leave any Entry blank");
			} else if(totalInitialHands > 13) {
				submitInitialHands.style.backgroundColor = 'red';
				console.error('Total Inital Hands cannot be more than 13!');
			} else if(submitInitialHands.innerHTML == 'Edit IH') {
				submitInitialHands.innerHTML = 'Submit IH';
				submitInitialHands.style.backgroundColor = '';

				submitFinalHands.setAttribute('disabled', true);
				submitScore.setAttribute('disabled', 'true');
				
				for(let i = 0; i < totalPlayers; i++) {
					inputInitialHands[i].removeAttribute('disabled');
					inputFinalHands[i].setAttribute('disabled', 'true');
				}				
			} else {
				isInitialHandsSubmitted = true;
				isInitialHandsFilled = true;
	
				submitInitialHands.innerHTML = 'Edit IH';
				submitInitialHands.style.backgroundColor = 'lightgreen';
				submitFinalHands.removeAttribute('disabled');
	
				for(let i = 0; i < totalPlayers; i++) {
					inputInitialHands[i].setAttribute('disabled', 'true');
				}
				if(!isFinalHandsSubmitted) {
					for(let i = 0; i < totalPlayers; i++) {
						inputFinalHands[i].removeAttribute('disabled');
					}
				}				
			}
		}
		submitInitialHands.addEventListener('click', calculateInitialHands, false); 
		for(let i = 0; i < totalPlayers; i++) {
			inputInitialHands[i].addEventListener('change', resetSubmitInitialHands, false);
			inputInitialHands[i].removeAttribute('disabled');
		}
		
		function resetSubmitFinalHands() {
			isFinalHandsSubmitted = false;
			isFinalHandsFilled = true;
			submitFinalHands.style.backgroundColor = '';
		}
		function calculateFinalHands() {
			totalFinalHands = 0;
			isFinalHandsSubmitted = false;
			isFinalHandsFilled = true;
			submitFinalHands.style.backgroundColor = 'grey';

			for(let i = 0; i < totalPlayers; i++) {
				if(inputFinalHands[i].value == "") {
					isFinalHandsFilled = false;
				}
				totalFinalHands += parseInt(inputFinalHands[i].value);
			}

			if(!isFinalHandsFilled) {
				submitFinalHands.style.backgroundColor = 'red';
				console.error("Don't leave any Entry blank");
			} else if(totalFinalHands > 13) {
				submitFinalHands.style.backgroundColor = 'red';
				console.error('Total Inital Hands cannot be more than 13!');
			} else if(submitFinalHands.innerHTML == 'Edit FH') {
				submitFinalHands.innerHTML = 'Submit FH';
				submitFinalHands.style.backgroundColor = '';
				
				submitInitialHands.setAttribute('disabled', 'true');
				submitScore.setAttribute('disabled', 'true');

				for(let i = 0; i < totalPlayers; i++) {
					inputFinalHands[i].removeAttribute('disabled');
				}				
			} else {
				isFinalHandsSubmitted = true;
				isFinalHandsFilled = true;
	
				submitFinalHands.innerHTML = 'Edit FH';
				submitFinalHands.style.backgroundColor = 'lightgreen';
				
				submitInitialHands.removeAttribute('disabled');			
				submitScore.removeAttribute('disabled');

				for(let i = 0; i < totalPlayers; i++) {
					inputFinalHands[i].setAttribute('disabled', 'true');
				}				
			}
		}
		submitFinalHands.addEventListener('click', calculateFinalHands, false); 
		for(let i = 0; i < totalPlayers; i++) {
			inputFinalHands[i].addEventListener('change', resetSubmitFinalHands, false);
		}

		function calculateScore() {
			for(let i = 0; i < totalPlayers; i++) {
				
				let ih, fh, is = es = ts = 0; // initial hands, final hands, initial score, extra score, total score
				
				ih = inputInitialHands[i].value;
				fh = inputFinalHands[i].value;
				d = fh - ih;
				if(d >= 0) {
					is = ih * 10;
					es = d * 5;
				} else {
					is = fh * 10;
					es = d * 10;
				}
				ts = is + es;
				rowTotalScore[i+1].innerHTML = inputScore[i].value = ts;
				isScoreSubmitted = true;

				submitInitialHands.setAttribute('disabled', 'true');
				submitFinalHands.setAttribute('disabled', 'true');
				submitScore.setAttribute('disabled', 'true');
				submitScore.setAttribute('disabled', 'true');
				submitNewGame.removeAttribute('disabled', 'true');
			}
		}
		submitScore.addEventListener('click', calculateScore, false); 
	</script>
</body>
</html>